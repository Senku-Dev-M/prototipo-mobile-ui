<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Timebank App - Prototipo Móvil</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Paleta de Colores Oficial */
        :root {
            --color-primary: #008080; /* Verde Azulado (Teal) */
            --color-primary-hover: #006666; /* Teal más oscuro para hover */
            --color-primary-light: #e0f2f1; /* Teal muy claro para fondos sutiles */
            --color-primary-text: #004d40; /* Teal oscuro para texto */
            --color-accent: #FFA500; /* Mango */
            --color-text-primary: #333333; /* Gris Oscuro (Charcoal) */
            --color-text-secondary: #6b7280; /* Gris medio */
            --color-surface: #ffffff;
            --color-background: #F5F5F5; /* Gris Claro */
            --color-border: #e0e0e0; /* Gris para bordes */
            --color-danger: #dc2626;
            --color-danger-hover: #b91c1c;
        }

        body {
            background-color: var(--color-background);
            font-family: 'Inter', sans-serif;
            color: var(--color-text-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 1rem;
        }
        
        .app-container {
            width: 100%;
            max-width: 400px;
            height: 844px;
            max-height: 90vh;
            background-color: var(--color-surface);
            border-radius: 2.5rem;
            box-shadow: 0 25px 50px -12px rgb(0 0 0 / 0.25), 0 0 15px rgb(0 0 0 / 0.1);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            position: relative;
            border: 8px solid #111;
        }

        .mobile-screen { display: none; opacity: 0; transition: opacity 0.3s ease-in-out; }
        .mobile-screen.active { display: flex; flex-direction: column; height: 100%; opacity: 1; }

        .screen-header { padding: 1rem 1.5rem; border-bottom: 1px solid var(--color-border); display: flex; align-items: center; min-height: 60px; background-color: var(--color-surface); z-index: 5; }
        .screen-header .back-btn { font-size: 1.25rem; color: var(--color-text-secondary); margin-right: 1rem; cursor: pointer; }
        .screen-header h1 { font-size: 1.125rem; font-weight: 600; color: var(--color-text-primary); }
        
        .screen-content { flex-grow: 1; overflow-y: auto; padding: 1.5rem; background-color: var(--color-background); }
        .screen-content::-webkit-scrollbar { display: none; }
        .screen-content { -ms-overflow-style: none; scrollbar-width: none; }

        .btn-primary { background-color: var(--color-primary); color: white; text-align: center; padding: 0.875rem; border-radius: 0.75rem; width: 100%; font-weight: 600; transition: background-color 0.2s; }
        .btn-primary:hover { background-color: var(--color-primary-hover); }
        
        .btn-secondary { background-color: var(--color-border); color: var(--color-text-primary); text-align: center; padding: 0.875rem; width: 100%; font-weight: 500; border-radius: 0.75rem; }
        
        .btn-danger { background-color: var(--color-danger); color: white; text-align: center; padding: 0.875rem; border-radius: 0.75rem; width: 100%; font-weight: 600; transition: background-color 0.2s; }
        .btn-danger:hover { background-color: var(--color-danger-hover); }

        .btn-social { display: flex; align-items: center; justify-content: center; text-align: center; padding: 0.75rem; width: 100%; font-weight: 500; border-radius: 0.75rem; border: 1px solid var(--color-border); transition: background-color 0.2s; }
        .btn-social i { font-size: 1.25rem; }

        .input-group { position: relative; }
        .input-group i { position: absolute; left: 1rem; top: 50%; transform: translateY(-50%); color: var(--color-text-secondary); }
        .input-field { border: 1px solid var(--color-border); border-radius: 0.75rem; padding: 1.25rem 1rem 1.25rem 3rem; width: 100%; transition: border-color 0.2s, box-shadow 0.2s; background-color: #f8fafc;}
        .input-field:focus { border-color: var(--color-primary); box-shadow: 0 0 0 3px rgba(0, 128, 128, 0.2); outline: none; background-color: white; }
        
        .tab-bar { border-top: 1px solid var(--color-border); background-color: var(--color-surface); display: flex; justify-content: space-around; padding-top: 0.5rem; padding-bottom: 1rem; z-index: 10; }
        .tab-item { display: flex; flex-direction: column; align-items: center; color: var(--color-text-secondary); font-size: 0.75rem; cursor: pointer; flex: 1; position: relative; }
        .tab-item i { font-size: 1.5rem; margin-bottom: 0.25rem; }
        .tab-item.active { color: var(--color-primary); }
        .tab-notification { position: absolute; top: -2px; right: 20%; width: 8px; height: 8px; background-color: var(--color-accent); border-radius: 50%; border: 2px solid var(--color-surface); }

        .choice-tag { padding: 0.5rem 1rem; border: 1px solid var(--color-border); border-radius: 9999px; font-weight: 500; cursor: pointer; transition: all 0.2s ease-in-out; background-color: var(--color-surface); }
        .choice-tag:hover { border-color: var(--color-primary); color: var(--color-primary); }
        .choice-tag.selected { background-color: var(--color-primary); border-color: var(--color-primary); color: white; }

        .activity-tabs-mobile { display: flex; border-bottom: 2px solid var(--color-border); }
        .activity-tab-mobile { padding: 0.5rem 1rem; color: var(--color-text-secondary); font-weight: 500; cursor: pointer; border-bottom: 3px solid transparent; flex: 1; text-align: center;}
        .activity-tab-mobile.active { color: var(--color-primary); border-bottom-color: var(--color-primary); }
        .activity-content-mobile { display: none; }
        .activity-content-mobile.active { display: block; }

        #categories-carousel-mobile::-webkit-scrollbar { display: none; }
        #categories-carousel-mobile { -ms-overflow-style: none; scrollbar-width: none; }

        .form-card { background-color: var(--color-surface); border-radius: 1rem; padding: 1rem; margin-bottom: 1.25rem; box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1); }
        .form-label { display: flex; align-items: center; font-size: 0.875rem; font-weight: 600; margin-bottom: 0.75rem; color: var(--color-primary-text); }
        .form-label i { margin-right: 0.75rem; width: 20px; text-align: center; color: var(--color-primary); }
        .form-input { width: 100%; border: 1px solid var(--color-border); border-radius: 0.5rem; padding: 0.75rem; background-color: #f8fafc; }
        .form-input:focus { border-color: var(--color-primary); box-shadow: 0 0 0 3px rgba(0, 128, 128, 0.2); outline: none; background-color: var(--color-surface); }
        .form-step { display: none; }
        .form-step.active { display: block; }

        .modal-overlay { position: absolute; inset: 0; background-color: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; z-index: 50; opacity: 0; pointer-events: none; transition: opacity 0.3s; }
        .modal-overlay.active { opacity: 1; pointer-events: auto; }
        .modal-content { background-color: white; padding: 1.5rem; border-radius: 1rem; width: 90%; max-width: 350px; text-align: center; transform: scale(0.95); transition: transform 0.3s; }
        .modal-overlay.active .modal-content { transform: scale(1); }
        
        .rating-stars .fa-star { color: var(--color-border); cursor: pointer; transition: color 0.2s; font-size: 2rem; }
        .rating-stars .fa-star.selected, .rating-stars .fa-star:hover, .rating-stars .fa-star:hover ~ .fa-star { color: var(--color-accent); }

        .day-selector { display: flex; justify-content: space-between; }
        .day-tag { width: 36px; height: 36px; border-radius: 50%; border: 1px solid var(--color-border); display: flex; align-items: center; justify-content: center; font-weight: 600; cursor: pointer; transition: all 0.2s; }
        .day-tag.selected { background-color: var(--color-primary); color: white; border-color: var(--color-primary); }
    </style>
</head>
<body>
    <div class="app-container">
        <div id="mobile-screen-container" class="flex-grow overflow-hidden">
            <!-- Flujo 1: Registro y Preferencias -->
            <div id="screen-welcome" class="mobile-screen">
                <div class="screen-content flex flex-col h-full justify-center bg-white" style="background: linear-gradient(180deg, var(--color-surface) 70%, var(--color-primary-light));">
                    <div class="flex-grow flex flex-col items-center justify-center text-center">
                        <img src="https://placehold.co/120x120/008080/ffffff?text=TB" alt="[Logo de Timebank]" class="rounded-full mb-6">
                        <h1 class="text-3xl font-bold text-gray-800">Intercambia tu tiempo</h1>
                        <p class="text-gray-500 mt-2 px-4">Únete a una comunidad donde tus habilidades son la moneda.</p>
                    </div>
                    <div class="p-4">
                         <!-- Llamada a la acción ajustada -->
                         <div class="text-center mb-6">
                            <p class="font-semibold text-teal-800"><i class="fa-solid fa-gift mr-2 text-teal-500"></i>¡Regístrate y obtén <span class="font-bold">5 créditos</span> de bienvenida!</p>
                        </div>
                        <div class="space-y-3">
                            <button class="btn-primary" onclick="showMobileScreen('screen-register')">Crear Cuenta</button>
                            <button class="btn-secondary" onclick="showMobileScreen('screen-login')">Ya tengo una cuenta</button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="screen-login" class="mobile-screen">
                <div class="screen-content !p-0 flex flex-col h-full bg-cover bg-center" style="background: linear-gradient(170deg, var(--color-primary-light) 0%, #f0f9ff 100%);">
                    <button class="absolute top-5 left-5 text-2xl text-gray-600 z-20" onclick="goBackMobile()"><i class="fa-solid fa-arrow-left"></i></button>
                    <div class="flex-grow flex flex-col items-center justify-center p-6 text-center">
                        <img src="https://placehold.co/90x90/008080/ffffff?text=TB" alt="[Logo de Timebank]" class="rounded-full mb-4 shadow-md">
                        <h1 class="text-2xl font-bold" style="color: var(--color-primary-text);">Bienvenido de Nuevo</h1>
                        <p class="text-sm text-gray-600">Nos alegra verte otra vez.</p>
                    </div>
                    <div class="p-6 bg-white rounded-t-3xl shadow-2xl">
                        <div class="space-y-4">
                            <div class="input-group"><i class="fa-solid fa-envelope"></i><input type="email" class="input-field" placeholder="Correo electrónico" value="usuario@email.com"></div>
                            <div class="input-group"><i class="fa-solid fa-lock"></i><input type="password" class="input-field" placeholder="Contraseña" value="password"></div>
                            <button class="btn-primary mt-2" onclick="login()">Iniciar Sesión</button>
                        </div>
                        <div class="py-4 flex items-center"><div class="flex-grow border-t border-gray-200"></div><span class="flex-shrink mx-4 text-gray-400 text-xs">O CONTINUAR CON</span><div class="flex-grow border-t border-gray-200"></div></div>
                        <div class="grid grid-cols-3 gap-4">
                            <button class="btn-social bg-white hover:bg-gray-50"><i class="fa-brands fa-google text-red-500"></i></button>
                            <button class="btn-social bg-white hover:bg-gray-50"><i class="fa-brands fa-apple text-black"></i></button>
                            <button class="btn-social bg-white hover:bg-gray-50"><i class="fa-brands fa-facebook text-blue-600"></i></button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="screen-register" class="mobile-screen">
                <div class="screen-content !p-0 flex flex-col h-full bg-cover bg-center" style="background: linear-gradient(170deg, var(--color-primary-light) 0%, #f0f9ff 100%);">
                    <button class="absolute top-5 left-5 text-2xl text-gray-600 z-20" onclick="goBackMobile()"><i class="fa-solid fa-arrow-left"></i></button>
                    <div class="flex-grow flex flex-col items-center justify-center p-6 text-center">
                         <img src="https://placehold.co/90x90/008080/ffffff?text=TB" alt="[Logo de Timebank]" class="rounded-full mb-4 shadow-md">
                        <h1 class="text-2xl font-bold" style="color: var(--color-primary-text);">Únete a la Comunidad</h1>
                        <p class="text-sm text-gray-600">Crea tu cuenta para empezar a intercambiar.</p>
                    </div>
                    <div class="p-6 bg-white rounded-t-3xl shadow-2xl">
                        <div class="space-y-4">
                            <div class="input-group"><i class="fa-solid fa-user"></i><input type="text" class="input-field" placeholder="Nombre"></div>
                            <div class="input-group"><i class="fa-solid fa-envelope"></i><input type="email" class="input-field" placeholder="Correo electrónico"></div>
                            <div class="input-group"><i class="fa-solid fa-lock"></i><input type="password" class="input-field" placeholder="Contraseña"></div>
                            <button class="btn-primary mt-2" onclick="showMobileScreen('screen-preferences')">Siguiente</button>
                        </div>
                        <div class="py-4 flex items-center"><div class="flex-grow border-t border-gray-200"></div><span class="flex-shrink mx-4 text-gray-400 text-xs">O REGISTRARSE CON</span><div class="flex-grow border-t border-gray-200"></div></div>
                        <div class="grid grid-cols-3 gap-4">
                            <button class="btn-social bg-white hover:bg-gray-50"><i class="fa-brands fa-google text-red-500"></i></button>
                            <button class="btn-social bg-white hover:bg-gray-50"><i class="fa-brands fa-apple text-black"></i></button>
                            <button class="btn-social bg-white hover:bg-gray-50"><i class="fa-brands fa-facebook text-blue-600"></i></button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="screen-preferences" class="mobile-screen">
                <div class="screen-header"><button class="back-btn" onclick="goBackMobile()"><i class="fa-solid fa-arrow-left"></i></button><h1>Completa tu perfil</h1></div>
                <div class="screen-content space-y-6">
                    <div class="flex flex-col items-center"><img src="https://placehold.co/120x120/e0f2f1/004d40?text=Foto" alt="[Avatar de usuario]" class="w-24 h-24 rounded-full object-cover"><button class="text-sm font-semibold mt-2" style="color: var(--color-primary);">Subir foto</button></div>
                    <textarea class="input-field !p-3" placeholder="Escribe una breve descripción sobre ti..." rows="3"></textarea>
                    <div><h2 class="font-semibold mb-2">Habilidades que ofreces</h2><div class="flex flex-wrap gap-2" id="skills-container-mobile"></div></div>
                    <div><h2 class="font-semibold mb-2">Servicios que te interesan</h2><div class="flex flex-wrap gap-2" id="interests-container-mobile"></div></div>
                    <button class="btn-primary" onclick="login()">Finalizar y Entrar</button>
                </div>
            </div>

            <!-- Flujo 2: Ofrecer un Servicio (Dividido en Pasos) -->
            <div id="screen-create-service" class="mobile-screen">
                <div class="screen-header"><button class="back-btn" onclick="goBackMobile()"><i class="fa-solid fa-arrow-left"></i></button><h1>Ofrecer un Servicio</h1></div>
                <div class="p-4 border-b bg-white">
                    <p id="step-title" class="text-center text-sm font-semibold text-gray-600"></p>
                    <div class="w-full bg-gray-200 rounded-full h-1.5 mt-2">
                        <div id="progress-bar" class="bg-[var(--color-primary)] h-1.5 rounded-full transition-all duration-300"></div>
                    </div>
                </div>
                <div class="screen-content">
                    <div id="form-step-1" class="form-step">
                        <div class="form-card">
                            <label class="form-label"><i class="fa-solid fa-pen-to-square"></i>Título del servicio</label>
                            <input type="text" value="Clases de Guitarra Acústica" class="form-input">
                        </div>
                        <div class="form-card">
                            <label class="form-label"><i class="fa-solid fa-grip"></i>Categoría</label>
                            <select class="form-input"><option>Clases y Talleres</option><option>Jardinería</option><option>Tecnología</option></select>
                        </div>
                         <div class="form-card">
                            <label class="form-label"><i class="fa-solid fa-align-left"></i>Descripción</label>
                            <textarea rows="6" class="form-input">Enseño desde cero, no necesitas experiencia. ¡Anímate a tocar tus canciones favoritas!</textarea>
                        </div>
                        <button class="btn-primary mt-4" onclick="showFormStep(2)">Siguiente</button>
                    </div>
                    <div id="form-step-2" class="form-step">
                        <div class="form-card">
                            <label class="form-label"><i class="fa-solid fa-calendar-days"></i>Días Disponibles</label>
                            <div class="day-selector">
                                <div class="day-tag">L</div><div class="day-tag">M</div><div class="day-tag selected">M</div><div class="day-tag">J</div><div class="day-tag selected">V</div><div class="day-tag">S</div><div class="day-tag">D</div>
                            </div>
                        </div>
                        <div class="form-card">
                            <label class="form-label"><i class="fa-solid fa-map-marker-alt"></i>Ubicación</label>
                            <input type="text" placeholder="Ej: Zona Central, El Alto" class="form-input">
                        </div>
                        <div class="form-card">
                            <label class="form-label"><i class="fa-solid fa-hourglass-half"></i>Costo del Servicio (por el total)</label>
                            <div class="flex items-center justify-center gap-4 bg-gray-100 p-3 rounded-lg">
                               <button id="decrement-cost" class="w-10 h-10 rounded-full text-lg font-bold text-white bg-[var(--color-primary)] hover:bg-[var(--color-primary-hover)]">-</button>
                               <span id="cost-value" class="text-2xl font-bold w-20 text-center">1</span>
                               <button id="increment-cost" class="w-10 h-10 rounded-full text-lg font-bold text-white bg-[var(--color-primary)] hover:bg-[var(--color-primary-hover)]">+</button>
                            </div>
                             <p class="text-center text-sm text-gray-500 mt-2">Créditos</p>
                        </div>
                        <div class="form-card">
                            <label class="form-label"><i class="fa-solid fa-images"></i>Fotos del Servicio</label>
                            <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center text-gray-500 cursor-pointer hover:bg-gray-50 transition-colors">
                                <i class="fa-solid fa-cloud-arrow-up text-3xl mb-2 text-[var(--color-primary)]"></i>
                                <p class="font-semibold">Añadir fotos</p>
                                <p class="text-xs">Sube hasta 5 imágenes</p>
                            </div>
                        </div>
                        <div class="flex gap-3 mt-4">
                            <button class="btn-secondary flex-1" onclick="showFormStep(1)">Atrás</button>
                            <button class="btn-primary flex-1" onclick="showMobileScreen('screen-create-confirm')">Publicar Servicio</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div id="screen-create-confirm" class="mobile-screen">
                <div class="screen-content flex flex-col items-center justify-center text-center">
                    <div class="w-24 h-24 rounded-full flex items-center justify-center" style="background-color: var(--color-primary-light);"><i class="fa-solid fa-check text-4xl" style="color: var(--color-primary);"></i></div>
                    <h1 class="text-2xl font-bold mt-6">¡Servicio Publicado!</h1><p class="text-gray-500 mt-1">Tu servicio ya está visible.</p>
                    <button class="btn-primary mt-8" onclick="showMobileScreen('screen-profile', 'profile')">Volver a mi perfil</button>
                </div>
            </div>

            <!-- Flujo 3: Explorar y Solicitar -->
            <div id="screen-explore" class="mobile-screen">
                <div class="screen-header"><h1>Explorar</h1></div>
                <div class="screen-content space-y-6">
                    <div class="flex items-center bg-white p-2 rounded-lg shadow-sm border border-transparent focus-within:border-[var(--color-primary)] transition-all">
                        <i class="fa-solid fa-magnifying-glass text-gray-400 mx-2"></i>
                        <input type="text" placeholder="Buscar servicios, habilidades..." class="flex-grow bg-transparent !border-0 !ring-0 !shadow-none !p-0 focus:!ring-0">
                    </div>
                    <div class="p-4 rounded-xl flex justify-between items-center text-white" style="background: linear-gradient(45deg, var(--color-primary), #20B2AA);">
                        <div>
                            <p class="text-sm opacity-80">Tu Balance</p>
                            <p class="text-3xl font-bold">5 <span class="text-xl font-normal">Créditos</span></p>
                        </div>
                        <button class="bg-white/20 hover:bg-white/30 text-white font-bold py-2 px-4 rounded-lg text-sm">Ofrecer</button>
                    </div>
                    
                    <div>
                        <h2 class="font-bold text-lg mb-2">Categorías</h2>
                        <div id="categories-carousel-mobile" class="flex gap-3 overflow-x-auto pb-2"></div>
                    </div>

                    <div>
                        <h2 class="font-bold text-lg mb-2">Nuevos Servicios</h2>
                        <div class="grid grid-cols-2 gap-4">
                            <div class="bg-white rounded-lg shadow-sm cursor-pointer overflow-hidden group" onclick="showMobileScreen('screen-service-detail')">
                                <div class="relative">
                                    <img src="https://placehold.co/300x200/a5b4fc/1e1b4b?text=Música" alt="" class="w-full h-24 object-cover group-hover:scale-105 transition-transform duration-300">
                                    <img src="https://placehold.co/100x100/fbcfe8/831843?text=AP" alt="[Avatar de Ana Pérez]" class="w-8 h-8 rounded-full object-cover absolute bottom-2 right-2 border-2 border-white">
                                </div>
                                <div class="p-3">
                                    <h3 class="font-semibold text-sm truncate">Clases de Guitarra</h3>
                                    <div class="flex justify-between items-center text-xs mt-1">
                                        <div class="text-yellow-500"><i class="fa-solid fa-star"></i> 4.9</div>
                                        <div class="text-gray-500">M, V</div>
                                    </div>
                                    <p class="text-sm font-bold mt-2" style="color: var(--color-primary);">1 Crédito</p>
                                </div>
                            </div>
                            <div class="bg-white rounded-lg shadow-sm cursor-pointer overflow-hidden group" onclick="showMobileScreen('screen-service-detail')">
                                <div class="relative">
                                    <img src="https://placehold.co/300x200/86efac/14532d?text=Jardín" alt="" class="w-full h-24 object-cover group-hover:scale-105 transition-transform duration-300">
                                     <img src="https://placehold.co/100x100/fed7aa/854d0e?text=CR" alt="[Avatar de Carlos Ruiz]" class="w-8 h-8 rounded-full object-cover absolute bottom-2 right-2 border-2 border-white">
                                </div>
                                <div class="p-3">
                                    <h3 class="font-semibold text-sm truncate">Ayuda Jardinería</h3>
                                     <div class="flex justify-between items-center text-xs mt-1">
                                        <div class="text-yellow-500"><i class="fa-solid fa-star"></i> 4.8</div>
                                        <div class="text-gray-500">S, D</div>
                                    </div>
                                    <p class="text-sm font-bold mt-2" style="color: var(--color-primary);">2 Créditos</p>
                                </div>
                            </div>
                        </div>
                    </div>
                     <div>
                        <h2 class="font-bold text-lg mb-2">Cerca de ti</h2>
                        <div class="bg-white rounded-lg shadow-sm cursor-pointer overflow-hidden p-3 flex gap-3 items-center">
                            <img src="https://placehold.co/400x300/e5e7eb/4b5563?text=Mapa" alt="" class="w-24 h-24 object-cover rounded-lg">
                            <div class="flex-grow">
                                <h3 class="font-semibold">Paseo de Perros</h3>
                                <p class="text-sm text-gray-500">Por Laura G.</p>
                                <p class="text-xs text-gray-400 mt-1"><i class="fa-solid fa-map-marker-alt mr-1"></i>A 500m de ti</p>
                                <p class="text-sm mt-2 font-bold" style="color: var(--color-primary);">1 Crédito</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div id="screen-service-detail" class="mobile-screen">
                <div class="screen-content !p-0 flex-grow">
                    <div class="absolute top-4 left-4 z-10 bg-white/70 backdrop-blur-sm w-10 h-10 rounded-full flex items-center justify-center" onclick="goBackMobile()"><i class="fa-solid fa-arrow-left text-gray-800"></i></div>
                    <img src="https://placehold.co/400x300/a5b4fc/1e1b4b?text=Música" alt="" class="w-full h-60 object-cover">
                    <div class="p-4 space-y-4 bg-white rounded-t-2xl -mt-4 relative">
                        <div class="flex justify-between items-start">
                            <div>
                                <h1 class="text-2xl font-bold">Clases de guitarra</h1>
                                <div class="flex items-center gap-2 text-sm text-gray-500 mt-1">
                                    <span class="bg-teal-100 text-teal-800 text-xs font-medium px-2.5 py-0.5 rounded-full">Clases</span>
                                    <span><i class="fa-solid fa-map-marker-alt mr-1"></i>Zona Central</span>
                                </div>
                            </div>
                            <div class="text-right">
                                <p class="text-2xl font-bold" style="color: var(--color-primary);">1</p>
                                <p class="text-sm text-gray-500 -mt-1">Crédito</p>
                            </div>
                        </div>
                        <div class="flex items-center bg-gray-50 rounded-lg p-3 cursor-pointer" onclick="showMobileScreen('screen-public-profile')">
                            <img src="https://placehold.co/100x100/fbcfe8/831843?text=AP" alt="[Avatar de Ana Pérez]" class="w-12 h-12 rounded-full object-cover">
                            <div class="ml-3 flex-grow">
                                <p class="font-semibold">Ana Pérez</p>
                                <p class="text-sm text-gray-500"><i class="fa-solid fa-star text-yellow-400"></i> 4.9 (12 reseñas)</p>
                            </div>
                            <i class="fa-solid fa-chevron-right text-gray-400"></i>
                        </div>
                        <div>
                            <h2 class="font-semibold mb-2">Días Disponibles</h2>
                            <div class="day-selector">
                                <div class="day-tag">L</div><div class="day-tag">M</div><div class="day-tag selected">M</div><div class="day-tag">J</div><div class="day-tag selected">V</div><div class="day-tag">S</div><div class="day-tag">D</div>
                            </div>
                        </div>
                        <div>
                            <h2 class="font-semibold mb-1">Descripción</h2>
                            <p class="text-gray-600 text-sm">Enseño desde cero, no necesitas experiencia. Aprenderás acordes, ritmos y tus canciones favoritas. ¡La primera clase es para conocernos!</p>
                        </div>
                        <div>
                            <h2 class="font-semibold mb-2">Galería</h2>
                            <div class="grid grid-cols-3 gap-2">
                                <img src="https://placehold.co/200x200/a5b4fc/1e1b4b?text=" alt="" class="rounded-lg h-24 w-full object-cover">
                                <img src="https://placehold.co/200x200/a5b4fc/1e1b4b?text=" alt="" class="rounded-lg h-24 w-full object-cover">
                                <img src="https://placehold.co/200x200/a5b4fc/1e1b4b?text=" alt="" class="rounded-lg h-24 w-full object-cover">
                            </div>
                        </div>
                        <div class="text-center pt-4">
                            <button class="text-sm font-medium text-gray-500 hover:text-red-600"><i class="fa-solid fa-flag mr-2"></i>Reportar Servicio</button>
                        </div>
                    </div>
                </div>
                <div class="p-4 border-t bg-white">
                    <button class="btn-primary" onclick="showMobileScreen('screen-request-form')">Solicitar Servicio</button>
                </div>
            </div>

            <div id="screen-request-form" class="mobile-screen">
                <div class="screen-header"><button class="back-btn" onclick="goBackMobile()"><i class="fa-solid fa-arrow-left"></i></button><h1>Enviar Solicitud</h1></div>
                <div class="screen-content">
                    <div class="p-4 bg-white rounded-lg shadow-sm">
                        <p class="text-sm text-gray-600 mb-2">Enviando solicitud a <span class="font-semibold text-teal-700">Ana Pérez</span> por su servicio de <span class="font-semibold text-teal-700">Clases de Guitarra</span>.</p>
                        <div class="form-card !p-0 !shadow-none">
                            <label class="form-label"><i class="fa-solid fa-pen"></i>Escribe un mensaje</label>
                            <textarea rows="5" class="form-input" placeholder="¡Hola! Estoy muy interesado en tus clases. ¿Podríamos coordinar un horario?">¡Hola! Estoy muy interesado en tus clases.</textarea>
                        </div>
                        <div class="form-card !p-0 !shadow-none mt-4">
                            <label class="form-label"><i class="fa-solid fa-paperclip"></i>Adjuntar imagen (opcional)</label>
                            <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center text-gray-500 cursor-pointer hover:bg-gray-50 transition-colors">
                                <i class="fa-solid fa-camera text-3xl mb-2 text-gray-400"></i>
                                <p class="font-semibold text-sm">Añadir una foto</p>
                            </div>
                        </div>
                        <button class="btn-primary mt-6" onclick="showConfirmationModal(true)">Confirmar y Enviar Solicitud</button>
                    </div>
                </div>
            </div>

            <div id="screen-request-sent" class="mobile-screen">
                <div class="screen-content flex flex-col items-center justify-center text-center">
                    <div class="w-24 h-24 rounded-full flex items-center justify-center bg-teal-100"><i class="fa-solid fa-paper-plane text-4xl text-teal-600"></i></div>
                    <h1 class="text-2xl font-bold mt-6">¡Solicitud Enviada!</h1>
                    <p class="text-gray-500 mt-2 px-4">Recibirás una notificación cuando Ana acepte tu solicitud. Puedes ver el estado en tus mensajes.</p>
                    <button class="btn-primary mt-8" onclick="showMobileScreen('screen-messages', 'messages')">Ir a mis Mensajes</button>
                </div>
            </div>
            
            <div id="screen-activity" class="mobile-screen">
                <div class="screen-header"><h1>Mi Actividad</h1></div>
                <div class="screen-content !p-0">
                    <div class="activity-tabs-mobile px-4 bg-white">
                        <div class="activity-tab-mobile active" onclick="showActivityTabMobile('recibidas')">Recibidas</div>
                        <div class="activity-tab-mobile" onclick="showActivityTabMobile('enviadas')">Enviadas</div>
                        <div class="activity-tab-mobile" onclick="showActivityTabMobile('historial')">Historial</div>
                    </div>
                    <div id="content-recibidas" class="activity-content-mobile active p-4 space-y-3">
                        <div class="bg-white rounded-lg p-3 shadow-sm flex items-center gap-3">
                            <img src="https://placehold.co/100x100/fed7aa/854d0e?text=CR" alt="[Avatar de Carlos Ruiz]" class="w-12 h-12 rounded-full">
                            <div class="flex-grow">
                                <p class="font-semibold">Solicitud de Carlos Ruiz</p>
                                <p class="text-sm text-gray-500">Servicio: Ayuda con Jardinería</p>
                                <div class="flex mt-2 space-x-2"><button class="btn-secondary flex-1 text-sm py-1">Rechazar</button><button class="btn-primary flex-1 text-sm py-1">Aceptar</button></div>
                            </div>
                        </div>
                    </div>
                    <div id="content-enviadas" class="activity-content-mobile p-4 space-y-3">
                        <div class="bg-white rounded-lg p-3 shadow-sm">
                            <div class="flex items-center gap-3">
                                <img src="https://placehold.co/100x100/fbcfe8/831843?text=AP" alt="[Avatar de Ana Pérez]" class="w-12 h-12 rounded-full">
                                <div class="flex-grow">
                                    <p class="font-semibold">Solicitud a Ana Pérez</p>
                                    <p class="text-sm text-gray-500">Servicio: Clases de Guitarra</p>
                                </div>
                                <span class="text-xs font-medium text-amber-600 bg-amber-100 px-2 py-1 rounded-full">Pendiente</span>
                            </div>
                            <div class="flex mt-2 space-x-2"><button class="btn-danger w-full text-sm py-1" onclick="showCancelModal(true)">Cancelar Solicitud</button></div>
                        </div>
                        <div class="bg-white rounded-lg p-3 shadow-sm">
                            <div class="flex items-center gap-3">
                                <img src="https://placehold.co/100x100/fed7aa/854d0e?text=CR" alt="[Avatar de Carlos Ruiz]" class="w-12 h-12 rounded-full">
                                <div class="flex-grow">
                                    <p class="font-semibold">Solicitud a Carlos Ruiz</p>
                                    <p class="text-sm text-gray-500">Servicio: Ayuda con Jardinería</p>
                                </div>
                                <span class="text-xs font-medium text-green-600 bg-green-100 px-2 py-1 rounded-full">Aceptado</span>
                            </div>
                            <div class="flex mt-2 space-x-2"><button class="btn-primary w-full text-sm py-1" onclick="showRatingModal(true)">Marcar como Completado</button></div>
                        </div>
                    </div>
                    <div id="content-historial" class="activity-content-mobile p-4 space-y-3">
                        <div class="bg-white rounded-lg p-3 shadow-sm flex items-center gap-4">
                             <img src="https://placehold.co/100x100/fbcfe8/831843?text=AP" alt="[Avatar de Ana Pérez]" class="w-12 h-12 rounded-full">
                            <div class="flex-grow">
                                <p class="font-semibold text-sm">Clases con Ana Pérez</p>
                                <p class="text-xs text-gray-500">15 Jul, 2024 - <span class="font-medium text-green-600">Completado</span></p>
                            </div>
                            <span class="font-bold text-red-500 text-sm">-1 Crédito</span>
                        </div>
                    </div>
                </div>
            </div>

            <div id="screen-messages" class="mobile-screen">
                <div class="screen-header"><h1>Mensajes</h1></div>
                <div class="screen-content !p-0">
                    <div class="p-4">
                        <div class="flex items-center bg-white p-2 rounded-lg shadow-sm border border-transparent focus-within:border-[var(--color-primary)] transition-all">
                            <i class="fa-solid fa-magnifying-glass text-gray-400 mx-2"></i>
                            <input type="text" placeholder="Buscar mensajes..." class="flex-grow bg-transparent !border-0 !ring-0 !shadow-none !p-0 focus:!ring-0">
                        </div>
                    </div>
                    <div class="px-4 space-y-1">
                        <!-- Mensaje no leído -->
                        <div class="bg-white rounded-lg p-3 flex items-center gap-4 cursor-pointer hover:bg-gray-50" onclick="showMobileScreen('screen-chat')">
                            <div class="relative">
                                <img src="https://placehold.co/100x100/fbcfe8/831843?text=AP" alt="[Avatar de Ana Pérez]" class="w-12 h-12 rounded-full">
                                <span class="absolute bottom-0 right-0 block h-3 w-3 rounded-full bg-green-500 border-2 border-white"></span>
                            </div>
                            <div class="flex-grow overflow-hidden">
                                <div class="flex justify-between items-center">
                                    <p class="font-semibold text-sm">Ana Pérez</p>
                                    <p class="text-xs text-teal-500 font-semibold">Ahora</p>
                                </div>
                                <p class="text-sm text-gray-800 truncate font-semibold">¡Genial! ¿Jueves a las 5pm?</p>
                            </div>
                             <div class="w-2 h-2 rounded-full bg-teal-500 self-center"></div>
                        </div>
                        <!-- Mensaje leído -->
                        <div class="bg-white rounded-lg p-3 flex items-center gap-4 cursor-pointer hover:bg-gray-50" onclick="showMobileScreen('screen-chat')">
                             <div class="relative">
                                <img src="https://placehold.co/100x100/fed7aa/854d0e?text=CR" alt="[Avatar de Carlos Ruiz]" class="w-12 h-12 rounded-full">
                             </div>
                            <div class="flex-grow overflow-hidden">
                                 <div class="flex justify-between items-center">
                                    <p class="font-medium text-sm text-gray-600">Carlos Ruiz</p>
                                    <p class="text-xs text-gray-400">Ayer</p>
                                </div>
                                <p class="text-sm text-gray-500 truncate">¡Gracias por la ayuda con el jardín!</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


            <div id="screen-profile" class="mobile-screen">
                <div class="screen-content !p-0">
                    <div class="h-28" style="background-color: var(--color-primary);"></div>
                    <div class="p-4 bg-white rounded-t-2xl -mt-12">
                        <div class="flex items-end -mt-12 mb-4">
                            <img src="https://placehold.co/150x150/e0f2f1/004d40?text=Yo" alt="[Avatar del usuario]" class="w-24 h-24 rounded-full object-cover border-4 border-white shadow-md">
                            <div class="ml-4 flex-grow">
                                <h2 class="text-xl font-bold">Mi Nombre</h2>
                                <p class="text-gray-500 text-sm">Miembro desde 2024</p>
                            </div>
                        </div>
                        <div class="rounded-lg p-4 text-center text-white mb-6" style="background: linear-gradient(45deg, var(--color-primary), #20B2AA);">
                            <p class="opacity-80">Mi Balance</p>
                            <p class="text-3xl font-bold">5 <span class="text-xl font-medium">Créditos</span></p>
                        </div>
                        
                        <div class="grid grid-cols-3 gap-2 text-center text-sm mb-6">
                            <div class="p-2 bg-gray-100 rounded-lg">
                                <i class="fa-solid fa-user-pen text-teal-600"></i>
                                <p class="mt-1">Editar Perfil</p>
                            </div>
                             <div class="p-2 bg-gray-100 rounded-lg">
                                <i class="fa-solid fa-eye text-teal-600"></i>
                                <p class="mt-1">Ver Público</p>
                            </div>
                             <div class="p-2 bg-gray-100 rounded-lg">
                                <i class="fa-solid fa-gear text-teal-600"></i>
                                <p class="mt-1">Ajustes</p>
                            </div>
                        </div>

                        <div class="form-card">
                            <h3 class="font-semibold mb-2">Sobre Mí</h3>
                            <p class="text-sm text-gray-600">¡Hola! Soy un entusiasta del aprendizaje y me encanta compartir lo que sé.</p>
                        </div>
                        <div class="form-card">
                            <h3 class="font-semibold mb-2">Mis Habilidades</h3>
                            <div class="flex flex-wrap gap-2"><span class="choice-tag selected !text-xs">Guitarra</span><span class="choice-tag selected !text-xs">Cocina</span></div>
                        </div>
                        <div class="form-card">
                            <h3 class="font-semibold mb-2">Mis Servicios</h3>
                            <div class="border rounded-lg p-3 flex justify-between items-center"><div><p class="font-medium">Clases de Guitarra</p><p class="text-sm text-green-600 font-medium">Activo</p></div><button class="btn-secondary text-sm py-1 px-3">Gestionar</button></div>
                        </div>
                        <div class="text-center mt-6">
                             <button class="text-red-600 font-semibold p-2" onclick="showMobileScreen('screen-welcome')"><i class="fa-solid fa-right-from-bracket mr-2"></i>Cerrar Sesión</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Pantalla de Perfil Público -->
            <div id="screen-public-profile" class="mobile-screen">
                <div class="screen-header"><button class="back-btn" onclick="goBackMobile()"><i class="fa-solid fa-arrow-left"></i></button><h1>Perfil de Ana</h1></div>
                <div class="screen-content space-y-6">
                    <div class="flex flex-col items-center">
                        <img src="https://placehold.co/150x150/fbcfe8/831843?text=AP" alt="[Avatar de Ana Pérez]" class="w-24 h-24 rounded-full object-cover">
                        <h2 class="text-xl font-bold mt-3">Ana Pérez</h2>
                        <p class="text-gray-500 text-sm">Miembro desde 2023</p>
                        <button class="btn-primary mt-4 w-auto px-6" onclick="showMobileScreen('screen-chat')">Contactar</button>
                    </div>
                    <div class="bg-white p-4 rounded-lg shadow-sm">
                        <h3 class="font-semibold mb-2">Sobre Ana</h3>
                        <p class="text-sm text-gray-600">Apasionada por la música y la enseñanza. Llevo más de 5 años tocando la guitarra y me encanta compartir mi conocimiento con otros.</p>
                    </div>
                    <div class="bg-white p-4 rounded-lg shadow-sm">
                        <h3 class="font-semibold mb-2">Habilidades</h3>
                        <div class="flex flex-wrap gap-2"><span class="choice-tag selected !text-xs !bg-teal-50 !text-teal-800">Guitarra</span><span class="choice-tag selected !text-xs !bg-teal-50 !text-teal-800">Ukelele</span></div>
                    </div>
                    <div class="bg-white p-4 rounded-lg shadow-sm">
                        <h3 class="font-semibold mb-2">Otros Servicios de Ana</h3>
                        <div class="border rounded-lg p-3 flex justify-between items-center"><div><p class="font-medium">Clases de Ukelele</p><p class="text-sm text-gray-500">1 Crédito</p></div><button class="btn-secondary text-sm py-1 px-3">Ver</button></div>
                    </div>
                    <div class="bg-white p-4 rounded-lg shadow-sm">
                        <h3 class="font-semibold mb-2">Reseñas (12)</h3>
                        <div class="border-t pt-3">
                            <div class="flex items-start gap-3">
                                <img src="https://placehold.co/100x100/fed7aa/854d0e?text=CR" alt="[Avatar de Carlos Ruiz]" class="w-10 h-10 rounded-full">
                                <div>
                                    <p class="font-semibold text-sm">Carlos Ruiz</p>
                                    <div class="text-xs text-yellow-500 my-1"><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i></div>
                                    <p class="text-sm text-gray-600">¡Excelente profesora! Muy paciente y explica todo de maravilla.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Pantalla de Chat -->
            <div id="screen-chat" class="mobile-screen">
                <div class="screen-header !p-2">
                    <button class="back-btn !mr-2" onclick="goBackMobile()"><i class="fa-solid fa-arrow-left"></i></button>
                    <img src="https://placehold.co/100x100/fbcfe8/831843?text=AP" alt="[Avatar de Ana Pérez]" class="w-10 h-10 rounded-full">
                    <div class="ml-3">
                        <h1 class="font-semibold text-sm leading-tight">Ana Pérez</h1>
                        <p class="text-xs text-green-500 leading-tight">En línea</p>
                    </div>
                </div>
                <div class="screen-content flex flex-col !p-4">
                    <div class="p-3 rounded-lg bg-teal-50 border border-teal-200 text-center text-xs text-teal-800 mb-4">
                        <p>Esta conversación es sobre el servicio <span class="font-semibold">"Clases de Guitarra"</span>.</p>
                    </div>
                    <div class="flex-grow space-y-4">
                        <div class="flex items-end gap-2.5">
                            <div class="bg-gray-200 p-3 rounded-r-lg rounded-b-lg max-w-xs">
                                <p class="text-sm text-gray-800">¡Hola! Claro que sí, tengo disponibilidad.</p>
                                <p class="text-xs text-gray-500 text-right mt-1">10:30 AM</p>
                            </div>
                        </div>
                        <div class="flex items-end gap-2.5 justify-end">
                            <div class="text-white p-3 rounded-l-lg rounded-b-lg max-w-xs" style="background-color: var(--color-primary);">
                                <p class="text-sm">¡Genial! ¿Jueves a las 5pm?</p>
                                <p class="text-xs text-white/70 text-right mt-1">10:31 AM</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="p-2 border-t bg-white flex items-center gap-2">
                    <button class="w-10 h-10 flex-shrink-0 text-gray-500 hover:text-teal-600"><i class="fa-solid fa-paperclip text-xl"></i></button>
                    <input type="text" placeholder="Escribe un mensaje..." class="flex-grow bg-gray-100 rounded-full py-2 px-4 focus:outline-none focus:ring-2 focus:ring-teal-500">
                    <button class="w-10 h-10 flex-shrink-0 rounded-full text-white bg-[var(--color-primary)] hover:bg-[var(--color-primary-hover)]"><i class="fa-solid fa-paper-plane"></i></button>
                </div>
            </div>
        </div>
        <nav id="main-tab-bar" class="tab-bar hidden">
            <div id="tab-explore" class="tab-item" onclick="showMobileScreen('screen-explore', 'explore')"><i class="fa-solid fa-magnifying-glass"></i><span>Explorar</span></div>
            <div id="tab-activity" class="tab-item" onclick="showMobileScreen('screen-activity', 'activity')"><i class="fa-solid fa-handshake"></i><span>Actividad</span></div>
            <div id="tab-create" class="tab-item" onclick="showMobileScreen('screen-create-service', 'create')"><i class="fa-solid fa-plus-square"></i><span>Ofrecer</span></div>
            <div id="tab-messages" class="tab-item" onclick="showMobileScreen('screen-messages', 'messages')"><i class="fa-solid fa-comments"></i><span class="tab-notification"></span><span>Mensajes</span></div>
            <div id="tab-profile" class="tab-item" onclick="showMobileScreen('screen-profile', 'profile')"><i class="fa-solid fa-user"></i><span>Perfil</span></div>
        </nav>
        
        <!-- Modal de Confirmación -->
        <div id="confirmation-modal" class="modal-overlay">
            <div class="modal-content">
                <i class="fa-solid fa-hourglass-half text-4xl text-teal-500 mb-4"></i>
                <h2 class="text-lg font-bold mb-2">Confirmar Solicitud</h2>
                <p class="text-gray-600 text-sm mb-4">Este servicio descontará <span class="font-bold text-teal-600">1 Crédito</span> de tu balance. ¿Deseas continuar?</p>
                <div class="flex gap-3">
                    <button class="btn-secondary flex-1" onclick="showConfirmationModal(false)">Cancelar</button>
                    <button class="btn-primary flex-1" onclick="sendRequest()">Sí, confirmar</button>
                </div>
            </div>
        </div>
        
        <!-- Modal de Calificación -->
        <div id="rating-modal" class="modal-overlay">
            <div class="modal-content">
                <i class="fa-solid fa-star text-4xl text-amber-400 mb-4"></i>
                <h2 class="text-lg font-bold mb-2">Calificar Servicio</h2>
                <p class="text-gray-600 text-sm mb-4">¿Qué tal fue tu experiencia con Carlos Ruiz?</p>
                <div class="rating-stars flex justify-center gap-2 mb-4">
                    <i class="fa-solid fa-star"></i>
                    <i class="fa-solid fa-star"></i>
                    <i class="fa-solid fa-star"></i>
                    <i class="fa-solid fa-star"></i>
                    <i class="fa-solid fa-star"></i>
                </div>
                <textarea class="form-input w-full mb-4" rows="3" placeholder="Deja un comentario..."></textarea>
                <div class="flex gap-3">
                    <button class="btn-secondary flex-1" onclick="showRatingModal(false)">Omitir</button>
                    <button class="btn-primary flex-1" onclick="submitRating()">Enviar Calificación</button>
                </div>
            </div>
        </div>
        
        <!-- Modal de Cancelación -->
        <div id="cancel-modal" class="modal-overlay">
            <div class="modal-content">
                <i class="fa-solid fa-triangle-exclamation text-4xl text-red-500 mb-4"></i>
                <h2 class="text-lg font-bold mb-2">¿Estás seguro?</h2>
                <p class="text-gray-600 text-sm mb-4">Esta acción no se puede deshacer. La solicitud será cancelada permanentemente.</p>
                <div class="flex gap-3">
                    <button class="btn-secondary flex-1" onclick="showCancelModal(false)">No, mantener</button>
                    <button class="btn-danger flex-1" onclick="confirmCancelRequest()">Sí, cancelar</button>
                </div>
            </div>
        </div>

    </div>

    <script>
        let mobileScreenHistory = ['screen-welcome'];
        const mainTabBar = document.getElementById('main-tab-bar');
        const confirmationModal = document.getElementById('confirmation-modal');
        const ratingModal = document.getElementById('rating-modal');
        const cancelModal = document.getElementById('cancel-modal');
        
        function showConfirmationModal(show) {
            if (show) { confirmationModal.classList.add('active'); } 
            else { confirmationModal.classList.remove('active'); }
        }
        
        function showRatingModal(show) {
            if (show) { ratingModal.classList.add('active'); }
            else { ratingModal.classList.remove('active'); }
        }

        function showCancelModal(show) {
            if (show) { cancelModal.classList.add('active'); }
            else { cancelModal.classList.remove('active'); }
        }
        
        function submitRating() {
            showRatingModal(false);
            showMobileScreen('screen-activity', 'activity');
        }

        function sendRequest() {
            showConfirmationModal(false);
            showMobileScreen('screen-request-sent');
        }
        
        function confirmCancelRequest() {
            showCancelModal(false);
            // Aquí iría la lógica para cancelar la solicitud
            // Por ahora, solo cerramos el modal
        }

        function showMobileScreen(screenId, tabId) {
            const authScreens = ['screen-welcome', 'screen-login', 'screen-register', 'screen-preferences'];
            if (authScreens.includes(screenId)) {
                mainTabBar.classList.add('hidden');
            } else {
                mainTabBar.classList.remove('hidden');
            }

            if (screenId === 'screen-create-service') {
                showFormStep(1);
            }

            const currentScreen = mobileScreenHistory[mobileScreenHistory.length - 1];
            if (screenId !== currentScreen) { mobileScreenHistory.push(screenId); }
            document.querySelectorAll('.mobile-screen').forEach(s => s.classList.remove('active'));
            const activeScreen = document.getElementById(screenId);
            if (activeScreen) { activeScreen.classList.add('active'); }
            document.querySelectorAll('.tab-bar .tab-item').forEach(t => t.classList.remove('active'));
            if (tabId) {
                const activeTab = document.getElementById('tab-' + tabId);
                if (activeTab) activeTab.classList.add('active');
            }
        }
        
        function login() {
            showMobileScreen('screen-explore', 'explore');
        }

        function goBackMobile() {
            if (mobileScreenHistory.length > 1) {
                const currentScreenId = mobileScreenHistory.pop();
                if (currentScreenId === 'screen-login' || currentScreenId === 'screen-register') {
                    mobileScreenHistory = ['screen-welcome'];
                }
                const lastScreenId = mobileScreenHistory[mobileScreenHistory.length - 1];
                const screenToTabMap = { 
                    'screen-explore': 'explore', 
                    'screen-activity': 'activity', 
                    'screen-create-service': 'create', 
                    'screen-messages': 'messages',
                    'screen-profile': 'profile', 
                    'screen-service-detail':'explore', 
                    'screen-public-profile': 'explore',
                    'screen-chat':'messages' 
                };
                let lastTabId = null;
                for (const screen in screenToTabMap) {
                    if (lastScreenId.startsWith(screen)) { lastTabId = screenToTabMap[screen]; break; }
                }
                showMobileScreen(lastScreenId, lastTabId);
            }
        }

        function showActivityTabMobile(tabName) {
            document.querySelectorAll('.activity-content-mobile').forEach(c => c.classList.remove('active'));
            document.querySelectorAll('.activity-tab-mobile').forEach(t => t.classList.remove('active'));
            document.getElementById('content-' + tabName).classList.add('active');
            event.currentTarget.classList.add('active');
        }
        
        function showFormStep(step) {
            const step1 = document.getElementById('form-step-1');
            const step2 = document.getElementById('form-step-2');
            const stepTitle = document.getElementById('step-title');
            const progressBar = document.getElementById('progress-bar');

            if (step === 1) {
                step1.classList.add('active');
                step2.classList.remove('active');
                stepTitle.textContent = 'Paso 1 de 2: Información Básica';
                progressBar.style.width = '50%';
            } else {
                step1.classList.remove('active');
                step2.classList.add('active');
                stepTitle.textContent = 'Paso 2 de 2: Detalles y Fotos';
                progressBar.style.width = '100%';
            }
        }

        const skills = ["Diseño", "Programación", "Música", "Cocina", "Jardinería", "Reparaciones"];
        const interests = ["Idiomas", "Deportes", "Arte", "Tecnología", "Viajes"];
        const categories = [{ name: 'Tecnología', icon: 'fa-laptop-code' }, { name: 'Hogar', icon: 'fa-house-chimney' }, { name: 'Clases', icon: 'fa-chalkboard-user' }, { name: 'Bienestar', icon: 'fa-spa' }, { name: 'Eventos', icon: 'fa-champagne-glasses' }, { name: 'Mascotas', icon: 'fa-paw' }];

        function populateChoices(containerId, choices) {
            const container = document.getElementById(containerId);
            if (!container) return;
            container.innerHTML = '';
            choices.forEach(choice => {
                const tag = document.createElement('div');
                tag.classList.add('choice-tag');
                tag.textContent = choice;
                tag.onclick = () => { tag.classList.toggle('selected'); };
                container.appendChild(tag);
            });
        }

        function populateCategories() {
            const container = document.getElementById('categories-carousel-mobile');
            if (!container) return;
            container.innerHTML = '';
            categories.forEach(cat => {
                const card = document.createElement('div');
                card.className = 'flex-shrink-0 w-20 text-center cursor-pointer group';
                card.innerHTML = `<div class="w-16 h-16 mx-auto bg-white rounded-2xl shadow-sm flex items-center justify-center transition-all duration-300 group-hover:bg-teal-50 group-hover:shadow-lg"><i class="fa-solid ${cat.icon} text-2xl text-[var(--color-primary)]"></i></div><p class="text-xs mt-2 font-semibold text-gray-600">${cat.name}</p>`;
                container.appendChild(card);
            });
        }
        
        function setupCostCounter() {
            const decrementButton = document.getElementById('decrement-cost');
            const incrementButton = document.getElementById('increment-cost');
            const costValue = document.getElementById('cost-value');

            if (!decrementButton || !incrementButton || !costValue) return;

            let cost = 1;

            decrementButton.addEventListener('click', () => {
                if (cost > 1) {
                    cost--;
                    costValue.textContent = cost;
                }
            });

            incrementButton.addEventListener('click', () => {
                cost++;
                costValue.textContent = cost;
            });
        }
        
        function setupRatingStars() {
            const stars = document.querySelectorAll('.rating-stars .fa-star');
            stars.forEach((star, index) => {
                star.addEventListener('click', () => {
                    stars.forEach((s, i) => {
                        s.classList.toggle('selected', i <= index);
                    });
                });
            });
        }

        document.addEventListener('DOMContentLoaded', () => {
            showMobileScreen('screen-welcome');
            populateChoices('skills-container-mobile', skills);
            populateChoices('interests-container-mobile', interests);
            populateCategories();
            setupCostCounter();
            setupRatingStars();
            
            document.querySelectorAll('.day-tag').forEach(tag => {
                tag.addEventListener('click', () => {
                    tag.classList.toggle('selected');
                });
            });
        });
    </script>
</body>
</html>
